{"ast":null,"code":"var _jsxFileName = \"/Users/julien/Sites/react-ros-robot/src/components/Teleoperation.jsx\";\nimport React, { Component } from \"react\";\nimport Disarm from \"./Buttons/Disarm\";\nimport Arm from \"./Buttons/Arm\";\nimport { Joystick } from \"react-joystick-component\";\nimport { Row, Col, Container } from \"react-bootstrap\";\nimport Config from \"../scripts/config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Teleoperation extends Component {\n  constructor() {\n    super();\n    this.state = {\n      ros: null,\n      isArmed: \"bruh\"\n    };\n  }\n\n  init_connection() {\n    this.state.ros = new window.ROSLIB.Ros(); // Using window bc using CDN for ROSLIB and not NPM package\n    // Changing changing button color according to connection state\n\n    this.state.ros.on(\"connection\", () => {\n      this.setState({\n        connected: true\n      });\n    });\n    this.state.ros.on(\"close\", () => {\n      this.setState({\n        connected: false\n      }); //try to reconnect every 2 seconds\n\n      setTimeout(() => {\n        try {\n          this.state.ros.connect(\"ws://\" + Config.ROSBRIDGE_SERVER_IP + \":\" + Config.ROSBRIDGE_SERVER_PORT + \"\");\n        } catch (error) {\n          console.log(\"connection problem\");\n        }\n      }, Config.RECONNECTION_TIMER);\n    });\n\n    try {\n      this.state.ros.connect(\"ws://\" + Config.ROSBRIDGE_SERVER_IP + \":\" + Config.ROSBRIDGE_SERVER_PORT + \"\");\n    } catch (error) {\n      console.log(\"connection problem\");\n    }\n  }\n\n  handleMove() {\n    var cmd_vel = new window.ROSLIB.Topic({\n      ros: this.state.ros,\n      name: \"/mavros/setpoint_velocity/cmd_vel_unstamped\",\n      messageType: \"geometry_msgs/Twist\"\n    });\n    var twist = new window.ROSLIB.Message({\n      linear: {\n        x: 0.5,\n        y: 0.0,\n        z: 0.0\n      },\n      angular: {\n        x: 0.0,\n        y: 0.0,\n        z: 0.0\n      }\n    });\n    cmd_vel.publish(twist);\n  }\n\n  handleStop() {}\n\n  getDroneState() {\n    // create a pose subscriber\n    var state_subscriber = new window.ROSLIB.Topic({\n      ros: this.state.ros,\n      name: \"/mavros/state\",\n      messageType: \"mavros_msgs/State\"\n    });\n    state_subscriber.subscribe(message => {\n      this.setState({\n        isArmed: message.armed\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Teleoperation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          className: \"justify-content-md-center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            children: [\" \", /*#__PURE__*/_jsxDEV(Joystick, {\n              size: 80,\n              sticky: false,\n              baseColor: \"#EEEEEE\",\n              stickColor: \"#BBBBBB\",\n              move: this.handleMove,\n              stop: this.handleStop\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Teleoperation;","map":{"version":3,"sources":["/Users/julien/Sites/react-ros-robot/src/components/Teleoperation.jsx"],"names":["React","Component","Disarm","Arm","Joystick","Row","Col","Container","Config","Teleoperation","constructor","state","ros","isArmed","init_connection","window","ROSLIB","Ros","on","setState","connected","setTimeout","connect","ROSBRIDGE_SERVER_IP","ROSBRIDGE_SERVER_PORT","error","console","log","RECONNECTION_TIMER","handleMove","cmd_vel","Topic","name","messageType","twist","Message","linear","x","y","z","angular","publish","handleStop","getDroneState","state_subscriber","subscribe","message","armed","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Disarm from \"./Buttons/Disarm\";\nimport Arm from \"./Buttons/Arm\";\nimport { Joystick } from \"react-joystick-component\";\nimport { Row, Col, Container } from \"react-bootstrap\";\nimport Config from \"../scripts/config\";\n\nclass Teleoperation extends Component {\n  state = { ros: null, isArmed: \"bruh\" };\n\n  constructor() {\n    super();\n  }\n\n  init_connection() {\n    this.state.ros = new window.ROSLIB.Ros(); // Using window bc using CDN for ROSLIB and not NPM package\n\n    // Changing changing button color according to connection state\n    this.state.ros.on(\"connection\", () => {\n      this.setState({ connected: true });\n    });\n\n    this.state.ros.on(\"close\", () => {\n      this.setState({ connected: false });\n      //try to reconnect every 2 seconds\n      setTimeout(() => {\n        try {\n          this.state.ros.connect(\n            \"ws://\" +\n              Config.ROSBRIDGE_SERVER_IP +\n              \":\" +\n              Config.ROSBRIDGE_SERVER_PORT +\n              \"\"\n          );\n        } catch (error) {\n          console.log(\"connection problem\");\n        }\n      }, Config.RECONNECTION_TIMER);\n    });\n\n    try {\n      this.state.ros.connect(\n        \"ws://\" +\n          Config.ROSBRIDGE_SERVER_IP +\n          \":\" +\n          Config.ROSBRIDGE_SERVER_PORT +\n          \"\"\n      );\n    } catch (error) {\n      console.log(\"connection problem\");\n    }\n  }\n\n  handleMove() {\n    var cmd_vel = new window.ROSLIB.Topic({\n      ros: this.state.ros,\n      name: \"/mavros/setpoint_velocity/cmd_vel_unstamped\",\n      messageType: \"geometry_msgs/Twist\",\n    });\n\n    var twist = new window.ROSLIB.Message({\n      linear: {\n        x: 0.5,\n        y: 0.0,\n        z: 0.0,\n      },\n      angular: {\n        x: 0.0,\n        y: 0.0,\n        z: 0.0,\n      },\n    });\n    cmd_vel.publish(twist);\n  }\n\n  handleStop() {}\n\n  getDroneState() {\n    // create a pose subscriber\n    var state_subscriber = new window.ROSLIB.Topic({\n      ros: this.state.ros,\n      name: \"/mavros/state\",\n      messageType: \"mavros_msgs/State\",\n    });\n\n    state_subscriber.subscribe((message) => {\n      this.setState({ isArmed: message.armed });\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>Teleoperation</h2>\n        <Container>\n          <Row className=\"justify-content-md-center\">\n            <Col>\n              {\" \"}\n              <Joystick\n                size={80}\n                sticky={false}\n                baseColor=\"#EEEEEE\"\n                stickColor=\"#BBBBBB\"\n                move={this.handleMove}\n                stop={this.handleStop}\n              ></Joystick>\n            </Col>\n          </Row>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default Teleoperation;\n"]},"metadata":{},"sourceType":"module"}